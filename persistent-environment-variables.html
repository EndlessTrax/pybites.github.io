
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-site-verification" content="lyiNqmFUtae2FGps4eCalBloZekygEIfjiV8tSPrjMY" />
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/ribbons.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/custom.css">

    <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Atom">

    <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites RSS">

    <link rel="shortcut icon" href="https://pybit.es/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://pybit.es/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Julian" />
<meta name="description" content="In this article I'm going to show you how to declare persistent environment variables in Python Virtual Environments with python-dotenv." />
<meta name="keywords" content="Python, tips, virtualenv, virtual-environment, packages, env, learning, howto">
<meta property="og:site_name" content="PyBites"/>
<meta property="og:title" content="Persistent Virtualenv Environment Variables with python-dotenv"/>
<meta property="og:description" content="In this article I'm going to show you how to declare persistent environment variables in Python Virtual Environments with python-dotenv."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://pybit.es/persistent-environment-variables.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-10-06 18:18:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://pybit.es/author/julian.html">
<meta property="article:section" content="packages"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="tips"/>
<meta property="article:tag" content="virtualenv"/>
<meta property="article:tag" content="virtual-environment"/>
<meta property="article:tag" content="packages"/>
<meta property="article:tag" content="env"/>
<meta property="article:tag" content="learning"/>
<meta property="article:tag" content="howto"/>
<meta property="og:image" content="https://pybit.es/images/featured/pb-article.png">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pybites" />
<meta name="twitter:title" content="Persistent Virtualenv Environment Variables with python-dotenv" />
<meta name="twitter:description" content="In this article I'm going to show you how to declare persistent environment variables in Python Virtual Environments with python-dotenv." />
<meta name="twitter:image" content="https://pybit.es/images/featured/pb-article.png">

  <title>PyBites &ndash; Persistent Virtualenv Environment Variables with python-dotenv</title>


</head>
<body>


  <!-- change ribbon color based on topic -->
  <div class="ribbon right
      blue
  ">
    <a href="https://codechalleng.es/via/pybites" target="_blank">Click here to code!</a>
  </div>

  <!-- change aside color based on topic -->
    <aside class='blue'>
  
    <div>
      <a href="https://pybit.es">
          <img src="https://pybit.es/theme/img/article.png" alt="PyBites" title="PyBites">
      </a>
      <h1><a href="https://pybit.es">PyBites</a></h1>

<h2 id="sitesubtitle">A Community that Masters Python through Code Challenges</h2>
      <nav>
        <ul class="list">
          <li><a href="/pages/articles.html">Articles</a></li>
          <li><a href="/pages/challenges.html">Blog Challenges</a></li>
          <li><a href="https://codechalleng.es/">Python Exercises</a></li>
          <li><a href="https://training.talkpython.fm/courses/explore_100days_web/100-days-of-web-in-python">#100DaysOfCode</a></li>
          <li><a href="/pages/community.html">Join our Slack</a></li>
          <li><a href="/pages/search.html">Search</a></li>
        </ul>
      </nav>

      <div id='mc-dark'>
<!-- Begin MailChimp Signup Form -->
<hr class="softDivider">
<div id="mc_embed_signup">
<form action="//pybit.us14.list-manage.com/subscribe/post?u=822043293f280259d4b8d2a3e&amp;id=ac7e2eb9ef" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    
<div class="mc-field-group">
  <p><a href='http://us14.campaign-archive1.com/home/?u=822043293f280259d4b8d2a3e&id=ac7e2eb9ef'>Join our community</a> and grab our <i>Become a Better Python Developer</i> cheat sheet. Learn Python. Receive bonus material. Challenge yourself! (<a href="https://pybit.es/pages/privacy-policy">Privacy Policy</a>)</p>
    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
</div>
    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_822043293f280259d4b8d2a3e_ac7e2eb9ef" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Join Us" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->                  </div>

      <hr class="softDivider">

      <div id="ninjaWidget">
        <a href="https://codechalleng.es/via/pybites" target="_blank"><img src="https://codechalleng.es/static/img/honors/ninja_widget.png" alt="start earning PyBites Ninja Belts"></a>
      </div>
        
      <ul class="social">
        <li><a href="https://pybit.es/feeds/all.rss.xml" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/rss.png' alt='Our RSS Feed'></a></li>
        <li><a href="https://twitter.com/pybites" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/twitter.png' alt='Follow us on Twitter'></a></li>
        <li><a href="https://github.com/pybites/" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/github.png' alt='Follow us on Github'></a></li>
        <li><a href="https://instagram.com/pybites" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/instagram.png' alt='Follow us on Instagram'></a></li>
        <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/youtube.png' alt='Follow us on Youtube'></a></li>
        <li><a href="https://www.facebook.com/groups/pybites/" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/facebook.png' alt='Follow us on Facebook'></a></li>
      </ul>

      <br>
      <script src="https://apis.google.com/js/platform.js"></script>

	
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="persistent-environment-variables">Persistent Virtualenv Environment Variables with python-dotenv</h1>
    <p>
          Posted by <a href="https://pybit.es/author/julian.html">Julian</a> on Sat 06 October 2018 in <a href="https://pybit.es/category/packages.html">packages</a>


        &#8226; 3 min read
    </p>
  </header>


  <div>
    <p>I can't count the amount of times I've followed a tutorial or guide that's said something along the lines of "Store your API Keys in environment variables".</p>
<p>It's easy enough to do with <code>os.getenv</code> but the thing that drives me crazy is having to, 1) hardcode the environment variables as global variables in my OS or 2) redeclare them every time I initiate the terminal session.</p>
<p>In this article I'm going to show you (and to document for myself!) how to declare persistent environment variables in Python Virtual Environments with python-dotenv.</p>
<h2>Environment Variables in a Virtual Environment</h2>
<p>With a UNIX based OS you'd traditionally declare your environment variables by explicitly defining them at the OS level. Take variables <code>CLIENT_ID</code> and <code>CLIENT_SECRET</code> as an example:</p>
<div class="highlight"><pre><span></span><span class="o">#</span><span class="n">CLIENT_ID</span><span class="o">=</span><span class="ss">&quot;01234509876&quot;</span>
<span class="o">#</span><span class="n">CLIENT_SECRET</span><span class="o">=</span><span class="ss">&quot;julianandsilentbobstrikeback&quot;</span>
<span class="o">#</span>
<span class="o">#</span><span class="n">echo</span> <span class="err">$</span><span class="n">CLIENT_ID</span>
<span class="mi">0123450987</span>
<span class="o">#</span>
<span class="o">#</span><span class="n">echo</span> <span class="err">$</span><span class="n">CLIENT_SECRET</span>
<span class="n">julianandsilentbobstrikeback</span>
</pre></div>


<p>To do this within your Python Virtual Environment (venv) you'd do the same declarations as above after you've activated your venv. Doing this means your environment variables are within the virtual environment, not the global OS environment.</p>
<blockquote>
<p>Read more on <a href="https://pybit.es/the-beauty-of-virtualenv.html">Python Virtual Environments here</a>.</p>
</blockquote>
<p>This is all well and good except that when you deactivate and reactivate the venv, the environment variables are lost and you'll need to redeclare them.</p>
<h2>Enter python-dotenv</h2>
<p><code>python-dotenv</code> is a Python module that allows you to specify environment variables in traditional UNIX-like ".env" (dot-env) file within your Python project directory. This includes in venvs!</p>
<p>Here's the flow:</p>
<ol>
<li>Populate the <code>.env</code> file with your environment variables.</li>
<li>Import <code>python-dotenv</code> and call it at the start of your script.</li>
<li>Use whatever "getenv" method you use to import the environment variables, eg: <code>os.getenv()</code>.</li>
</ol>
<h2>python-dotenv Example</h2>
<h3>1. Create your <code>.env</code> file</h3>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span><span class="n">vim</span> <span class="p">.</span><span class="n">env</span>
<span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span><span class="n">cat</span> <span class="p">.</span><span class="n">env</span>
<span class="n">CLIENT_ID</span><span class="o">=</span><span class="ss">&quot;1234509876&quot;</span>
<span class="n">CLIENT_SECRET</span><span class="o">=</span><span class="ss">&quot;julianandsilentbobstrikeback&quot;</span>
<span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span>
</pre></div>


<h3>2. Import and Call python-dotenv</h3>
<p>I'm using a file called <code>routes.py</code> as my primary Python script here:</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="c1">#cat routes.py</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">()</span>
</pre></div>


<p>I begin by importing <code>load_dotenv</code> from the <code>dotenv</code>.</p>
<p>It's then just as simple as running <code>load_dotenv()</code> to make the <code>.env</code> file accessible to your script as your source of environment variables.</p>
<h3>3. Access the Environment Variables</h3>
<p>I've continued with <code>routes.py</code> by writing a function that uses <code>os.getenv</code> to pull and print the environment variables I specified in my <code>.env</code> file:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">load_dotenv</span><span class="p">()</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CLIENT_ID&quot;</span><span class="p">)</span>
<span class="n">secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CLIENT_SECRET&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">printenvironment</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The client id is: {client}.&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The secret id is: {secret}.&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">printenvironment</span><span class="p">()</span>
</pre></div>


<p><br>
Running this script returns the following:</p>
<div class="highlight"><pre><span></span><span class="o">#</span><span class="n">python</span> <span class="n">routes</span><span class="p">.</span><span class="n">py</span> 
<span class="n">The</span> <span class="n">client</span> <span class="n">id</span> <span class="k">is</span><span class="p">:</span> <span class="mi">1234509876</span><span class="p">.</span>
<span class="n">The</span> <span class="n">secret</span> <span class="n">id</span> <span class="k">is</span><span class="p">:</span> <span class="n">julianandsilentbobstrikeback</span><span class="p">.</span>
<span class="o">#</span>
</pre></div>


<h2>PERSISTENCE AT LAST!</h2>
<p>The original problem was that when you'd deactivate and reactivate the venv you'd lose the environment variables.</p>
<p>Watch the persistence in action!</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span><span class="n">deactivate</span>
<span class="o">#</span>
<span class="o">#</span>
<span class="o">#</span><span class="k">source</span> <span class="n">venv</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span>
<span class="p">(</span><span class="n">venv</span><span class="p">)</span><span class="o">#</span><span class="n">python</span> <span class="n">routes</span><span class="p">.</span><span class="n">py</span> 
<span class="n">The</span> <span class="n">client</span> <span class="n">id</span> <span class="k">is</span><span class="p">:</span> <span class="mi">1234509876</span><span class="p">.</span>
<span class="n">The</span> <span class="n">secret</span> <span class="n">id</span> <span class="k">is</span><span class="p">:</span> <span class="n">julianandsilentbobstrikeback</span><span class="p">.</span>
<span class="o">#</span>
</pre></div>


<p>Okay... I know. Anticlimactic. No! What am I saying?! Super handy and so time saver-y!</p>
<h2>.env Example File</h2>
<p>Pro-tip: if you're committing to a public repo, make sure .env files are listed in the .gitignore file. <strong>You don't want your environment variables being pushed to a public repo!</strong></p>
<p>That said, you'll want to let people know what environment variables to configure for themselves if they're going to clone your repo or use your script.</p>
<p>The nice way to do this is to create an "empty" .env.example file:</p>
<div class="highlight"><pre><span></span><span class="o">#</span><span class="n">vim</span> <span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">example</span>
<span class="n">CLIENT_ID</span><span class="o">=</span><span class="ss">&quot;&quot;</span>
<span class="n">CLIENT_SECRET</span><span class="o">=</span><span class="ss">&quot;&quot;</span>
</pre></div>


<h2>Conclusion</h2>
<p>This is one of those Python things I'll be taking with me to the grave. With the numerous apps and scripts I've created, managing these env variables has always been a pain.</p>
<p>But no more I say! I'll be using <code>python-dotenv</code> to manage everything.</p>
<hr>
<p>Keep Calm and Code in Python!</p>
<p>-- Julian</p>
  </div>

  <hr>
  <p><strong>See an error in this post? Please submit a pull request <a href='https://github.com/pybites/pybites.github.io-src' target='_blank'>on Github.</a></strong></p>

  <div class="tag-cloud">
    <p>
      <a href="https://pybit.es/tag/python.html">Python</a>
      <a href="https://pybit.es/tag/tips.html">tips</a>
      <a href="https://pybit.es/tag/virtualenv.html">virtualenv</a>
      <a href="https://pybit.es/tag/virtual-environment.html">virtual-environment</a>
      <a href="https://pybit.es/tag/packages.html">packages</a>
      <a href="https://pybit.es/tag/env.html">env</a>
      <a href="https://pybit.es/tag/learning.html">learning</a>
      <a href="https://pybit.es/tag/howto.html">howto</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-pybit-es';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; pybites </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89294245-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

	<script>window.twttr = (function(d, s, id) {
	var js, fjs = d.getElementsByTagName(s)[0],
		t = window.twttr || {};
	if (d.getElementById(id)) return t;
	js = d.createElement(s);
	js.id = id;
	js.src = "https://platform.twitter.com/widgets.js";
	fjs.parentNode.insertBefore(js, fjs);
	t._e = [];
	t.ready = function(f) {
		t._e.push(f);
	};
	return t;
	}(document, "script", "twitter-wjs"));</script>

  <script async defer src="https://buttons.github.io/buttons.js"></script>
	
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " PyBites ",
  "url" : "https://pybit.es",
  "image": "https://pybit.es/theme/img/profile.png",
  "description": "A Community that Masters Python through Code Challenges"
}
</script>

  <script async>(function(s,u,m,o,j,v){j=u.createElement(m);v=u.getElementsByTagName(m)[0];j.async=1;j.src=o;j.dataset.sumoSiteId='4262b3df2bb8820b75b4c7e09ef53c07d4d5376a3c0c6070d2fc19815019fc50';v.parentNode.insertBefore(j,v)})(window,document,'script','//load.sumo.com/');</script>

</body>
</html>