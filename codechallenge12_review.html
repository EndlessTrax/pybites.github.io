<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="It&#39;s end of the week again so we review the code challenge of this week: Build a Tic-tac-toe Game. It&#39;s never late to join, just fork us and start coding. Our solution and learning You can find...">
        <meta name="keywords" content="AI, codechallenges, game, learning, tictactoe">
        <link rel="icon" href="./favicon.ico">

        <title>Code Challenge 12 - Build a Tic-tac-toe Game - Review - PyBites</title>

        <!-- Stylesheets -->
        <link href="./theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Full Atom Feed" />
        <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Full RSS Feed" />
        <link href="https://pybit.es/feeds/challenges.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-89294245-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->


    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="./"><img class="mr20" src="./images/logo.png" alt="logo"></a>
                    </div>
                    <div class="nav pull-right">
                                <a  href="./">Home</a>
                                <a  href="./archives.html">Blog</a>
                                <a href="https://codechalleng.es" target="_blank">Platform</a>
                                <a  style="background-color: #ba9926!important; border-radius: 5px;" href="./pages/apply.html">Apply</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Code Challenge 12 - Build a Tic-tac-toe Game - Review</h1>
                      <p class="header-date"> <a href="./author/pybites.html">PyBites</a>, Sat 01 April 2017,  <a href="./category/challenges.html">Challenges</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="./tag/ai.html">AI</a>, <a href="./tag/codechallenges.html">codechallenges</a>, <a href="./tag/game.html">game</a>, <a href="./tag/learning.html">learning</a>, <a href="./tag/tictactoe.html">tictactoe</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>It's end of the week again so we review the code challenge of this week: <a href="http://pybit.es/codechallenge12.html">Build a Tic-tac-toe Game</a>. It's never late to join, just <a href="https://github.com/pybites/challenges">fork us</a> and start coding.</p>
<h2>Our solution and learning</h2>
<p>You can find our solution <a href="https://github.com/pybites/challenges/blob/solutions/12/tictactoe.py">here</a>. This was great learning! Here are some highlights:</p>
<ul>
<li>
<p>We went for the AI opponent to play against. Not sure if it is unbeatable, but it has some 'intelligence' because it knows when to win, block you or take the next best moves (more on this later). We need to know a score for each position which we calculate by counting the number of times each position is in a winning combination:</p>
<div class="highlight"><pre><span></span>WINNING_COMBINATIONS = (
    (7, 8, 9), (4, 5, 6), (1, 2, 3),
    (7, 4, 1), (8, 5, 2), (9, 6, 3),
    (1, 5, 9), (7, 5, 3),
)

POSITION_VALUES = Counter(
    itertools.chain(*WINNING_COMBINATIONS)
)
</pre></div>


</li>
<li>
<p>Like Hangman, you have to keep state, so a class worked best for us and it is important to use a suitable data structure: a list of key numbers in the order of a typical key pad:</p>
<div class="highlight"><pre><span></span><span class="nx">VALID_POSITIONS</span> <span class="o">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="p">...</span>

<span class="kr">class</span> <span class="nx">TicTacToe</span>:

    <span class="kt">def</span> <span class="nx">__init__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span><span class="o">:</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">board</span> <span class="o">=</span> <span class="p">[</span><span class="nx">None</span><span class="p">]</span> <span class="o">+</span> <span class="nx">len</span><span class="p">(</span><span class="nx">VALID_POSITIONS</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="nx">DEFAULT</span><span class="p">]</span>  <span class="err">#</span> <span class="nx">skip</span> <span class="nx">index</span> <span class="mi">0</span>

<span class="s1">&#39;&#39;&#39;Simple tictactoe game, board positions are like keyboard</span>
<span class="s1">                7 8 9</span>
<span class="s1">                4 5 6</span>
<span class="s1">                1 2 3</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="kd">@clear_screen</span>
<span class="nx">def</span> <span class="nx">__str__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        {} | {} | {}</span>
<span class="s1">        {} | {} | {}</span>
<span class="s1">        {} | {} | {}</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">board</span><span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="p">]</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">board</span><span class="p">[</span><span class="nx">4</span>:<span class="kt">7</span><span class="p">]</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">board</span><span class="p">[</span><span class="nx">1</span>:<span class="kt">4</span><span class="p">]))</span>
</pre></div>


<p>The decorator is probably overkill but we use print(game) in two places so we did not want to duplicate code nor did we feel it was pure to clear the screen as part of __str__ (OK maybe we exaggerated, but the <a href="https://en.wikipedia.org/wiki/Decorator_pattern">decorator</a> is a useful feature you probably end up using!)</p>
</li>
<li>
<p>Probably the most important method is to determine if there is a win state. is_win() loops over all winning combinations and if there is not a DEFAULT (_) in the 3 positions and they are of the same ('O' or 'X') we have a win:</p>
<div class="highlight"><pre><span></span>def is_win(self):
    for combo in WINNING_COMBINATIONS:
        a, b, c = combo
        combo_vals = set([self.board[a], self.board[b], self.board[c]])
        if DEFAULT not in combo_vals and len(combo_vals) == 1:
            return True
    return False
</pre></div>


</li>
<li>
<p>Under main we drive the interface. It is one of the few times we choose a "for / else" construct, which some advice against. However here we liked it because there is a clear use case: if we break out of the for loop we have a win, else we ended performing all max 9 turns/moves, so we enter the for's else = game ends in 'draw'. The advantage of this approach is that we did not have to calculate the 'draw' scenario. We separated computer vs manual into 2 methods: ai_move() and manual_move():</p>
<div class="highlight"><pre><span></span>while True:
    game = TicTacToe()

    turns = itertools.cycle([first, second])
    print(game)
    for _ in VALID_POSITIONS:
        player = next(turns)
        if player == COMPUTER:
            game.ai_move()
        else:
            game.manual_move()
        print(game)
        if game.is_win():
            print(&#39;Player {} wins&#39;.format(player))
            break
    else:  # for / else is frowned upon, I do like it here though!
        print(&#39;Draw&#39;)
</pre></div>


</li>
<li>
<p>The AI bit was the most interesting part. We went not as far as the full 8 steps in <a href="https://en.wikipedia.org/wiki/Tic-tac-toe#Strategy">tictactoe's strategy</a>, yet this will give you a bit of challenge. The computer checks first if it can win (end) the game, then if the player can win, if so prevent (block) that. If none of these two situations, it takes the best next move based on the before mentioned POSITION_VALUES which is a counter so its most_common() method returns most valuable positions first. Splitting this in multiple methods makes it easier maintainable.</p>
<div class="highlight"><pre><span></span>def ai_move(self):
    self._win_or_block() or self._take_best_next_free_pos()

def _win_or_block(self):
    for combo in WINNING_COMBINATIONS:
        a, b, c = combo
        combo_vals = [self.board[a], self.board[b], self.board[c]]
        # can only use unitiated positions
        if DEFAULT not in combo_vals:
            continue
        if combo_vals.count(COMPUTER) == 2:
            return self._update_board(combo, combo_vals)
        if combo_vals.count(PLAYER) == 2:
            return self._update_board(combo, combo_vals)
    return False

def _take_best_next_free_pos(self):
    for pos, _ in POSITION_VALUES.most_common():
        if self.board[pos] == DEFAULT:
            self.board[pos] = COMPUTER
            return True
    return False
</pre></div>


</li>
</ul>
<p>Again our full solution is <a href="https://github.com/pybites/challenges/blob/solutions/12/tictactoe.py">here</a>. Let us know if you have any questions or if you spot anything we could have done better.</p>
<h2>Community</h2>
<p>Here are some other ways to do it: from our <a href="https://github.com/pybites/challenges/blob/community/12/tictactoe-atakume.py">community branch</a> (remember you can submit code by PR!) and <a href="https://redd.it/61o56j">via reddit comment</a>). Reading other solutions to the same problem (as well as coding styles) is a great way to learn.</p>
<h2>Stay tuned</h2>
<p>Next week you will train your data analysis skills by parsing a movie data set. It will be fun :)</p>
<p>We hope you are enjoying these challenges, learning along the way. Let us know <a href="https://github.com/pybites/challenges/issues/new">if you have any issue</a> and/or <a href="mailto:pybitesblog@gmail.com">contact us</a> if you want to submit a cool challenge. See you next week ...</p>


    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'http-pybit-es';
                var disqus_identifier = 'codechallenge12_review.html';
                var disqus_url = './codechallenge12_review.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="./pages/community.html">Community</a></li>
                            <li><a href=".https://codechalleng.es/100days/">100 Days Of Code</a></li>
                            <li><a href="./pages/search.html">Search</a></li>
                            <li><a href="./pages/privacy-policy.html">Privacy Policy</a></li>
                            <li><a href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                            <li><a href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Reach Out</div>
                        <ul class="list-unstyled">
                            <li><a href="mailto:info@pybit.es" target="_blank">Email</a></li>
                            <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
                            <li><a href="https://facebook.com/pybites" target="_blank">Facebook</a></li>
                            <li><a href="https://github.com/pybites" target="_blank">Github</a></li>
                            <li><a href="https://github.com/PyBites-Open-Source" target="_blank">Open Source</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank">YouTube</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; PyBites 2016+</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>