
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-site-verification" content="lyiNqmFUtae2FGps4eCalBloZekygEIfjiV8tSPrjMY" />
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/ribbons.css">
  <link rel="stylesheet" type="text/css" href="https://pybit.es/theme/stylesheet/custom.css">

    <link href="https://pybit.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="PyBites Atom">

    <link href="https://pybit.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="PyBites RSS">

    <link rel="shortcut icon" href="https://pybit.es/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://pybit.es/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Julian" />
<meta name="description" content="Learn what a Generator is and check out some different examples." />
<meta name="keywords" content="python, tips, code, pybites, generators, iteration, yield">
<meta property="og:site_name" content="PyBites"/>
<meta property="og:title" content="Generators are Awesome, Learning by Example"/>
<meta property="og:description" content="Learn what a Generator is and check out some different examples."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://pybit.es/generators.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-03-17 09:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://pybit.es/author/julian.html">
<meta property="article:section" content="Concepts"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="tips"/>
<meta property="article:tag" content="code"/>
<meta property="article:tag" content="pybites"/>
<meta property="article:tag" content="generators"/>
<meta property="article:tag" content="iteration"/>
<meta property="article:tag" content="yield"/>
<meta property="og:image" content="https://pybit.es/images/featured/pb-article.png">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pybites" />
<meta name="twitter:title" content="Generators are Awesome, Learning by Example" />
<meta name="twitter:description" content="Learn what a Generator is and check out some different examples." />
<meta name="twitter:image" content="https://pybit.es/images/featured/pb-article.png">

  <title>PyBites &ndash; Generators are Awesome, Learning by Example</title>


</head>
<body>
<div id="codeChallengeWrapper">

  <div id="codeWithUs">

    <div class="quote-box">
      <div class="quote">

        <img src="https://codechalleng.es/static/img/honors/unlock.png" class="ninja" alt="earn the White PyBites Ninja">
        <img src="https://codechalleng.es/static/img/honors/unlock_yellow.png" class="ninja" alt="earn the Yellow PyBites Ninja">
        <img src="https://codechalleng.es/static/img/honors/unlock_orange.png" class="ninja" alt="earn the Orange PyBites Ninja">
        <img src="https://codechalleng.es/static/img/right-arrow.png" class="ninja" alt="right arrow">
        <img src="https://codechalleng.es/static/img/honors/unlock_red.png" class="ninja" alt="earn more PyBites Ninja belts and certificates">

        <hr>

        <blockquote>
          The best way to learn to <strong>code in Python</strong> is to <strong><a href="https://pybit.es/learn-by-doing.html" target="_blank">actually use the language</a></strong>.
          <br><br>
          Our platform offers <strong>effective Test Driven Learning</strong> which will be key to your progress.
          <br><br><br>
          Join thousands of Pythonistas and start coding!

          <br><br><br>
          <a href="https://codechalleng.es/via/pybites" target="_blank"><img src="https://codechalleng.es/static/img/ghlogin.png" alt="Join us on our PyBites Platform"></a>
        </blockquote>
  
      </div>
    </div>

  </div>

  <button class="center mui-btn mui-btn--flat mui-btn--primary" onclick="document.getElementById('codeWithUs').classList.toggle('open');">
    Land a better Python job? Try our coding platform &raquo;
  </button>

</div><!-- end codeChallengeWrapper -->

  <!-- change ribbon color based on topic -->
  <div class="ribbon right
      blue
  ">
    <a href="https://codechalleng.es/via/pybites" target="_blank">Click here to code!</a>
  </div>

  <!-- change aside color based on topic -->
    <aside class='blue'>
  
    <div>
      <a href="https://pybit.es">
          <img src="https://pybit.es/theme/img/article.png" alt="PyBites" title="PyBites">
      </a>
      <h1><a href="https://pybit.es">PyBites</a></h1>

<h2 id="sitesubtitle">A Community that Masters Python through Code Challenges</h2>
      <nav>
        <ul class="list">
          <li><a href="/pages/articles.html">Articles</a></li>
          <li><a href="/pages/challenges.html">Blog Challenges</a></li>
          <li><a href="https://codechalleng.es/">Python Exercises</a></li>
          <li><a href="https://training.talkpython.fm/courses/explore_100days_web/100-days-of-web-in-python">#100DaysOfCode</a></li>
          <li><a href="https://join.slack.com/t/pybites/shared_invite/enQtNDAxODc0MjEyODM2LTNiZjljNTI2NGJiNWI0MTRkNjY4YzQ1ZWU4MmQzNWQyN2Q4ZTQzMTk0NzkyZTRmMThlNmQzYTk5Y2Y5ZDM4NDU">Join our Slack</a></li>
          <li><a href="/pages/search.html">Search</a></li>
        </ul>
      </nav>

      <div id='mc-dark'>
<!-- Begin MailChimp Signup Form -->
<hr class="softDivider">
<div id="mc_embed_signup">
<form action="//pybit.us14.list-manage.com/subscribe/post?u=822043293f280259d4b8d2a3e&amp;id=ac7e2eb9ef" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
    
<div class="mc-field-group">
  <p><a href='http://us14.campaign-archive1.com/home/?u=822043293f280259d4b8d2a3e&id=ac7e2eb9ef'>Join our community</a> and grab our <i>Become a Better Python Developer</i> cheat sheet. Learn Python. Receive bonus material. Challenge yourself! (<a href="https://pybit.es/pages/privacy-policy">Privacy Policy</a>)</p>
    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
</div>
    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_822043293f280259d4b8d2a3e_ac7e2eb9ef" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Join Us" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->                  </div>

      <hr class="softDivider">

      <div id="ninjaWidget">
        <a href="https://codechalleng.es/via/pybites" target="_blank"><img src="https://codechalleng.es/static/img/honors/ninja_widget.png" alt="start earning PyBites Ninja Belts"></a>
      </div>
        
      <ul class="social">
        <li><a href="https://pybit.es/feeds/all.rss.xml" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/rss.png' alt='Our RSS Feed'></a></li>
        <li><a href="https://twitter.com/pybites" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/twitter.png' alt='Follow us on Twitter'></a></li>
        <li><a href="https://github.com/pybites/" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/github.png' alt='Follow us on Github'></a></li>
        <li><a href="https://instagram.com/pybites" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/instagram.png' alt='Follow us on Instagram'></a></li>
        <li><a href="https://www.youtube.com/channel/UCBn-uKDGsRBfcB0lQeOB_gA" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/youtube.png' alt='Follow us on Youtube'></a></li>
        <li><a href="https://www.facebook.com/groups/pybites/" target="_blank"><img src='https://pybit.es/theme/img/socialmedia/facebook.png' alt='Follow us on Facebook'></a></li>
      </ul>

      <br>
      <script src="https://apis.google.com/js/platform.js"></script>

	
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="generators">Generators are Awesome, Learning by Example</h1>
    <p>
          Posted by <a href="https://pybit.es/author/julian.html">Julian</a> on Fri 17 March 2017 in <a href="https://pybit.es/category/concepts.html">Concepts</a>


        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p>Playing around with context managers for last week’s <a href="http://pybit.es/codechallenge09.html">Challenge 09</a> introduced me to Python Generators and I’ll be forever grateful. They’re exactly what I didn’t know I needed!</p>
<p>First, for the uninitiated, what is a Generator? (If you’re already across Generators, feel free to skip this next part!).</p>
<h2>What is a Generator?</h2>
<p>Well, there’s actually not much to it. A generator is just a function that generates values specifically when called with <em>next()</em>. Take this absolutely simple generator for example:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">def</span> <span class="nv">num_gen</span><span class="ss">()</span>:
...     <span class="nv">yield</span> <span class="mi">1</span>
...     <span class="nv">yield</span> <span class="mi">2</span>
...     <span class="nv">yield</span> <span class="mi">3</span>
... 
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="nv">demo_gen</span> <span class="o">=</span> <span class="nv">num_gen</span><span class="ss">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="nv">Traceback</span> <span class="ss">(</span><span class="nv">most</span> <span class="nv">recent</span> <span class="k">call</span> <span class="nl">last</span><span class="ss">)</span>:
  <span class="nv">File</span> <span class="s2">&quot;</span><span class="s">&lt;stdin&gt;</span><span class="s2">&quot;</span>, <span class="nv">line</span> <span class="mi">1</span>, <span class="nv">in</span> <span class="o">&lt;</span><span class="nv">module</span><span class="o">&gt;</span>
<span class="nv">StopIteration</span>
</pre></div>


<p>As you can see, we have a function <em>num_gen()</em> which uses <em>yield</em> to return the numbers 1, 2 and 3.</p>
<p>Normally you’d return these numbers via some sort of loop or with 3x print() functions which would print the numbers 1, 2 and 3 all at once.</p>
<p>With a generator however, the numbers are only returned when called using the <em>next()</em> function. Here’s what the code does:</p>
<ol>
<li>
<p>We take <em>num_gen()</em> and assign it to a variable <em>demo_gen</em> to make this easier on us.</p>
</li>
<li>
<p>We use the <em>next()</em> function on <em>demo_gen</em> to request the “next” iteration of the demo_gen function. This results in <strong>the first yield only</strong> being returned.</p>
</li>
<li>
<p>Notice we then have to run <em>next(demo_gen)</em> two more times to see the next iteration in the code.</p>
</li>
<li>
<p>Once we’ve exhausted all of the yields within <em>num_gen()</em> running <em>next()</em> again results in a <em>StopIteration</em> error.</p>
</li>
</ol>
<blockquote>
<p>The StopIteration error appears because there are no more yield statements in the function. Calling next on the generator after this does not cause it to loop over and start again.</p>
</blockquote>
<h2>Generator Performance Gains</h2>
<p>One of the main reasons for using a generator is to avoid having performance issues. For this example it isn’t an issue to work with our 3 numbers in memory but what if we were to be dealing with lists of millions of numbers? </p>
<p>The performance hit for building lists of millions of numbers within memory isn’t mind blowingly bad but it’s definitely not a great practice.</p>
<p>Generators on the other hand get around the memory hogging by only loading the code into memory that’s returned by <em>yield</em>. That is, you’re not processing and storing the entire chunk of code/function in memory, just the next iteration you’re requesting with <em>next()</em>.</p>
<h2>Using a For Loop in a Generator</h2>
<p>You can use Generators in all sorts of ways. Here’s one that uses a For Loop to double the value of the number I throw into the generator. I can specify how many times the loop is going to run too:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">def</span> <span class="nv">double_nums</span><span class="ss">(</span><span class="nv">num</span>, <span class="nv">loops</span><span class="o">=</span><span class="mi">5</span><span class="ss">)</span>:
...     <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="nv">loops</span><span class="ss">)</span>:
...         <span class="nv">num</span> <span class="o">+=</span> <span class="nv">num</span>
...         <span class="nv">yield</span> <span class="nv">num</span>
... 
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="nv">demo_gen</span> <span class="o">=</span> <span class="nv">double_nums</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">16</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">32</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">64</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="nv">Traceback</span> <span class="ss">(</span><span class="nv">most</span> <span class="nv">recent</span> <span class="k">call</span> <span class="nl">last</span><span class="ss">)</span>:
  <span class="nv">File</span> <span class="s2">&quot;</span><span class="s">&lt;stdin&gt;</span><span class="s2">&quot;</span>, <span class="nv">line</span> <span class="mi">1</span>, <span class="nv">in</span> <span class="o">&lt;</span><span class="nv">module</span><span class="o">&gt;</span>
<span class="nv">StopIteration</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>


<h2>Using a While Loop within a Generator</h2>
<p>Now let’s say we want it to indefinitely double every number but only when we want to. The generator is necessary otherwise you’d run out memory and crash your machine.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">def</span> <span class="nv">num_gen</span><span class="ss">(</span><span class="nv">num</span><span class="ss">)</span>:
...     <span class="k">while</span> <span class="nv">True</span>:
...         <span class="nv">num</span> <span class="o">+=</span> <span class="nv">num</span>
...         <span class="nv">yield</span> <span class="nv">num</span>
... 
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="nv">demo_gen</span> <span class="o">=</span> <span class="nv">num_gen</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">16</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">32</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">64</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">next</span><span class="ss">(</span><span class="nv">demo_gen</span><span class="ss">)</span>
<span class="mi">128</span>
…
</pre></div>


<p>This code will continue doubling the number but only when <em>next()</em> asks for the number. Nothing is sitting in memory waiting to just return a number.</p>
<h2>Some more examples: Generators for chaining</h2>
<p>Here are some examples from our <a href="https://github.com/pybites/challenges">challenges repo (solutions branch)</a>:</p>
<ul>
<li>
<p>Get all permutations of a draw in a simple game:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">_get_permutations_draw</span><span class="ss">(</span><span class="nv">draw</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">1</span>, <span class="mi">8</span><span class="ss">)</span>:
        <span class="nv">yield</span> <span class="nv">from</span> <span class="nv">list</span><span class="ss">(</span><span class="nv">itertools</span>.<span class="nv">permutations</span><span class="ss">(</span><span class="nv">draw</span>, <span class="nv">i</span><span class="ss">))</span>
</pre></div>


<p>Note that yield from requires <a href="https://docs.python.org/3/whatsnew/3.3.html">&gt;= 3.3</a>.</p>
<p>Related: <a href="http://pybit.es/itertools-examples.html">5 cool things you can do with itertools</a></p>
</li>
<li>
<p>Get similar tags:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">get_similarities</span><span class="ss">(</span><span class="nv">tags</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">pair</span> <span class="nv">in</span> <span class="nv">product</span><span class="ss">(</span><span class="nv">tags</span>, <span class="nv">tags</span><span class="ss">)</span>:
        <span class="nv">pair</span> <span class="o">=</span> <span class="nv">tuple</span><span class="ss">(</span><span class="nv">sorted</span><span class="ss">(</span><span class="nv">pair</span><span class="ss">))</span>  
        <span class="nv">similarity</span> <span class="o">=</span> <span class="nv">SequenceMatcher</span><span class="ss">(</span><span class="nv">None</span>, <span class="o">*</span><span class="nv">pair</span><span class="ss">)</span>.<span class="nv">ratio</span><span class="ss">()</span>
        <span class="k">if</span> <span class="nv">SIMILAR</span> <span class="o">&lt;</span> <span class="nv">similarity</span> <span class="o">&lt;</span> <span class="nv">IDENTICAL</span>:
            <span class="nv">yield</span> <span class="nv">pair</span>
</pre></div>


</li>
</ul>
<p>We grep on yield in our <a href="https://github.com/pybites/blog_code">blog code repo</a> quite a bit:</p>
<ul>
<li>
<p>A tweet pipeline:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">get_tweets</span><span class="ss">(</span><span class="nv">search</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">tweet</span> <span class="nv">in</span> <span class="nv">tweepy</span>.<span class="nv">Cursor</span><span class="ss">(</span><span class="nv">api</span>.<span class="nv">search</span>,
                            <span class="nv">q</span><span class="o">=</span><span class="nv">search</span>,
                            <span class="nv">rpp</span><span class="o">=</span><span class="mi">100</span>,
                            <span class="nv">result_type</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">recent</span><span class="s2">&quot;</span>,
                            <span class="nv">include_entities</span><span class="o">=</span><span class="nv">True</span>,
                            <span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">en</span><span class="s2">&quot;</span><span class="ss">)</span>.<span class="nv">items</span><span class="ss">()</span>:
        <span class="k">if</span> <span class="nv">not</span> <span class="nv">tweet</span>.<span class="nv">retweeted</span> <span class="nv">and</span> <span class="s1">&#39;</span><span class="s">RT @</span><span class="s1">&#39;</span> <span class="nv">not</span> <span class="nv">in</span> <span class="nv">tweet</span>.<span class="nv">text</span>:
            <span class="nv">yield</span> <span class="nv">tweet</span>
</pre></div>


</li>
<li>
<p>Get all our challenges repo's forks:</p>
<div class="highlight"><pre><span></span><span class="nv">def</span> <span class="nv">get_forks</span><span class="ss">()</span>:
    <span class="nv">page_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nv">True</span>:
        <span class="nv">page_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nv">url</span> <span class="o">=</span> <span class="nv">FORK_URL</span> <span class="o">+</span> <span class="nv">str</span><span class="ss">(</span><span class="nv">page_num</span><span class="ss">)</span>
        <span class="nv">response</span> <span class="o">=</span> <span class="nv">requests</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">url</span><span class="ss">)</span>
        <span class="nv">d</span> <span class="o">=</span> <span class="nv">response</span>.<span class="nv">json</span><span class="ss">()</span>
        <span class="k">if</span> <span class="nv">not</span> <span class="nv">d</span>:
            <span class="k">return</span>
        <span class="k">for</span> <span class="nv">row</span> <span class="nv">in</span> <span class="nv">d</span>:
            <span class="nv">url</span> <span class="o">=</span> <span class="nv">row</span>[<span class="s1">&#39;</span><span class="s">html_url</span><span class="s1">&#39;</span>]
            <span class="nv">updated</span> <span class="o">=</span> <span class="nv">row</span>[<span class="s1">&#39;</span><span class="s">updated_at</span><span class="s1">&#39;</span>]
            <span class="nv">pushed</span> <span class="o">=</span> <span class="nv">row</span>[<span class="s1">&#39;</span><span class="s">pushed_at</span><span class="s1">&#39;</span>]
            <span class="nv">yield</span> <span class="nv">Fork</span><span class="ss">(</span><span class="nv">url</span>, <span class="nv">updated</span>, <span class="nv">pushed</span><span class="ss">)</span>
</pre></div>


</li>
</ul>
<h2>Using a Generator to SSH to Multiple Hosts Idea</h2>
<p>I came up with a <a href="https://github.com/pybites/challenges/blob/solutions/09/with_ssh.py">useful SSH script</a> for last week’s context manager challenge.</p>
<p>It works great but it’s only for one host.</p>
<p>A cool idea from here (that I’ll probably use for work now that I think about it!) would be to make a generator to create a list of node IP addresses to use with the ssh code.</p>
<p>The catch would be the SSH authentication for each server if your credentials aren’t the same across your fleet.</p>
<p>Simplistically but potentially it could look like this:</p>
<div class="highlight"><pre><span></span><span class="nv">net</span> <span class="o">=</span> <span class="nv">input</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">Input your IP net, e.g. 192.168.0</span><span class="s1">&#39;</span><span class="ss">)</span>

# <span class="nv">define</span> <span class="nv">the</span> <span class="nv">generator</span>
<span class="nv">def</span> <span class="nv">get_nodes</span><span class="ss">(</span><span class="nv">net</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">1</span>, <span class="mi">256</span><span class="ss">)</span>:
        <span class="nv">yield</span> <span class="s1">&#39;</span><span class="s">{}.{}</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">net</span>, <span class="nv">i</span><span class="ss">)</span>

# <span class="nv">consume</span> <span class="nv">it</span>
<span class="k">for</span> <span class="nv">node</span> <span class="nv">in</span> <span class="nv">get_nodes</span><span class="ss">()</span>:
    <span class="nv">print</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">Checking IP {}</span><span class="s1">&#39;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">node</span><span class="ss">))</span>
    <span class="nv">try</span>:
        <span class="nv">ssh</span> <span class="o">=</span> <span class="nv">paramiko</span>.<span class="nv">SSHClient</span><span class="ss">()</span>
        <span class="nv">ssh</span>.<span class="nv">set_missing_host_key_policy</span><span class="ss">(</span><span class="nv">paramiko</span>.<span class="nv">AutoAddPolicy</span><span class="ss">())</span>
        <span class="nv">ssh</span>.<span class="k">connect</span><span class="ss">(</span><span class="nv">node</span>, <span class="nv">username</span><span class="o">=</span><span class="nv">username</span>, <span class="nv">password</span><span class="o">=</span><span class="nv">password</span><span class="ss">)</span>
        <span class="nv">ssh_stdin</span>, <span class="nv">ssh_stdout</span>, <span class="nv">ssh_stderr</span> <span class="o">=</span> <span class="nv">ssh</span>.<span class="nv">exec_command</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">cat /etc/hostname</span><span class="s1">&#39;</span><span class="ss">)</span>
        <span class="nv">yield</span> <span class="nv">ssh_stdout</span>.<span class="nv">readlines</span><span class="ss">()</span>
    <span class="nv">finally</span>:
        <span class="nv">ssh</span>.<span class="nv">close</span><span class="ss">()</span>

    <span class="nv">confirm</span> <span class="o">=</span> <span class="nv">input</span><span class="ss">(</span>‘<span class="k">Do</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="k">continue</span>? <span class="s1">&#39;</span><span class="s">)</span>
    ...
</pre></div>


<p>Output (assuming 'net' was entered as 192.168.0):</p>
<div class="highlight"><pre><span></span><span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="c1">-- output --</span>
<span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span>
<span class="c1">-- output --</span>
<span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span>
<span class="c1">-- output --</span>
<span class="p">...</span>
<span class="p">...</span>
<span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">253</span>
<span class="c1">-- output --</span>
<span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">254</span>
<span class="c1">-- output --</span>
<span class="n">Checking</span> <span class="n">IP</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">255</span>
<span class="c1">-- output --</span>
</pre></div>


<p>(Note the lack of StopIteration. This is because the for loop catches that for you).</p>
<h2>Conclusion</h2>
<p>Generators are extremely useful for keeping memory usage low. Not a huge deal for your run of the mill script at home or on your laptop but definitely worth keeping in mind and learning for your coding arsenal.</p>
<blockquote>
<p>There are many ways to skin a… actually, we’re animal lovers here. There are many ways to code a solution! As I wrote the SSH script above I was thinking it’d be much easier to do it differently (not force the generator) but I wanted to for the sake of this post.</p>
</blockquote>
<p>Do you use generators in any creative ways? Maybe you can <em>generate</em> some interest with your solutions…  pun intended! <a href="https://www.youtube.com/watch?v=bcYppAs6ZdI">I’m here all week!</a>.</p>
<h2>next(PyBites_Generators)</h2>
<p>The next step (ha!) is to learn ’send' (yes, you can send data into a generator, how cool is that?!) -&gt; coroutines -&gt; asyncio ... So much to learn, so little time!</p>
<p>Keep Calm and Code in Python!</p>
<p>— Julian</p>
  </div>

  <hr>
  <p><strong>See an error in this post? Please submit a pull request <a href='https://github.com/pybites/pybites.github.io-src' target='_blank'>on Github.</a></strong></p>

  <div class="tag-cloud">
    <p>
      <a href="https://pybit.es/tag/python.html">python</a>
      <a href="https://pybit.es/tag/tips.html">tips</a>
      <a href="https://pybit.es/tag/code.html">code</a>
      <a href="https://pybit.es/tag/pybites.html">pybites</a>
      <a href="https://pybit.es/tag/generators.html">generators</a>
      <a href="https://pybit.es/tag/iteration.html">iteration</a>
      <a href="https://pybit.es/tag/yield.html">yield</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-pybit-es';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; pybites </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89294245-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

	<script>window.twttr = (function(d, s, id) {
	var js, fjs = d.getElementsByTagName(s)[0],
		t = window.twttr || {};
	if (d.getElementById(id)) return t;
	js = d.createElement(s);
	js.id = id;
	js.src = "https://platform.twitter.com/widgets.js";
	fjs.parentNode.insertBefore(js, fjs);
	t._e = [];
	t.ready = function(f) {
		t._e.push(f);
	};
	return t;
	}(document, "script", "twitter-wjs"));</script>

  <script async defer src="https://buttons.github.io/buttons.js"></script>
	
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " PyBites ",
  "url" : "https://pybit.es",
  "image": "https://pybit.es/theme/img/profile.png",
  "description": "A Community that Masters Python through Code Challenges"
}
</script>
</body>
</html>